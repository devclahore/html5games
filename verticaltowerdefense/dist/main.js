!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();var i=720,r=window.innerHeight/1080,a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvasElement=e,this.context=e.getContext("2d"),e.setAttribute("height",window.innerHeight),e.setAttribute("width",i*r)}return o(t,[{key:"drawImage",value:function(t,e,n,o,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"source-over",l=o*a,c=i*a;this.context.save(),this.context.globalCompositeOperation=s,this.context.globalAlpha=u,this.context.drawImage(t,(e-(l-o)/2)*r,(n-(c-i)/2)*r,l*r,c*r),this.context.restore()}},{key:"clear",value:function(){this.context.fillStyle="#e2fcbf",this.context.fillRect(0,0,this.canvasElement.clientWidth,this.canvasElement.clientHeight)}},{key:"fillRect",value:function(t,e,n,o,i){this.context.fillStyle=t,this.context.globalCompositeOperation="source-over",this.context.fillRect(e*r,n*r,o*r,i*r)}},{key:"writeText",value:function(t,e,n,o,i,a){this.context.fillStyle=n,this.context.font=e,this.context.textAlign=o,this.context.fillText(t,i*r,a*r)}},{key:"height",get:function(){return 1080}},{key:"width",get:function(){return i}},{key:"viewportRatio",get:function(){return r}},{key:"htmlElement",get:function(){return this.canvasElement}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={loadImage:function(t){return new Promise(function(e,n){var o=new Image;o.addEventListener("load",function(){e(o)},!1),o.addEventListener("error",function(){n(new Error("Failed to load "+t))}),o.src=t})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(0);(o=r)&&o.__esModule;var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"load",value:function(){throw new TypeError('Abstract class "Entity" cannot be instantiated directly.')}},{key:"draw",value:function(t){throw new TypeError('Abstract class "Entity" cannot be instantiated directly.')}},{key:"update",value:function(t){throw new TypeError('Abstract class "Entity" cannot be instantiated directly.')}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.doBoundsIntersect=function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=u(n(1)),r=u(n(2)),a=(u(n(0)),u(n(5)),n(3));function u(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.xPosition=t,n.yPosition=0,n.scale=1,n.totalTime=0,n.state="DESCENDING",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"load",value:function(){var t=this;return i.default.loadImage("images/green_blob.png").then(function(e){t.image=e})}},{key:"draw",value:function(t){t.drawImage(this.image,this.xPosition,this.yPosition,128,128,this.scale)}},{key:"update",value:function(t){var e=this.target;"DESCENDING"===this.state?this.yPosition=this.yPosition+10*t:"ATTACKING"===this.state&&e&&(e.isDestroyed?this.state="DESCENDING":this.totalTime-this.lastAttackTime>Math.PI&&(e.attack(1),this.lastAttackTime=this.totalTime)),this.totalTime+=t,this.scale=.05*Math.sin(2*this.totalTime)+1}},{key:"testWallCollision",value:function(t){if("ATTACKING"!==this.state){var e={x:this.xPosition,y:this.yPosition,width:128,height:128};(0,a.doBoundsIntersect)(t.boundingBox,e)&&(this.state="ATTACKING",this.target=t,this.lastAttackTime=this.totalTime)}}},{key:"yPos",get:function(){return this.yPosition}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=a(n(1)),r=a(n(2));a(n(0));function a(t){return t&&t.__esModule?t:{default:t}}n(3);var u=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.xPosition=t,o.yPosition=n,o.underAttack=!1,o.opacity=1,o.hits=3,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"load",value:function(){var t=this;return i.default.loadImage("images/wall.png").then(function(e){t.image=e})}},{key:"draw",value:function(t){this.destroyed||t.drawImage(this.image,this.xPosition,this.yPosition,128,108,1,this.opacity)}},{key:"update",value:function(t){var e=.33*this.hits;this.opacity>e&&(this.opacity-=.5*t)}},{key:"attack",value:function(t){this.hits-=t,this.hits<=0&&(this.destroyed=!0)}},{key:"boundingBox",get:function(){return{x:this.xPosition+20,y:this.yPosition+24,width:80,height:80}}},{key:"isDestroyed",get:function(){return this.destroyed}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=(u(n(1)),u(n(2))),r=(u(n(0)),u(n(4))),a=u(n(5));function u(t){return t&&t.__esModule?t:{default:t}}n(3);var s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.walls=[],t.monsters=[],t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default),o(e,[{key:"load",value:function(){}},{key:"addWallPiece",value:function(t,e){var n=this,o=Math.floor(t/120),i=Math.floor(e/120),r=new a.default(120*o-4,120*i+6);r.load().then(function(){return n.walls.push(r)})}},{key:"spawnMonster",value:function(){var t=this,e=Math.floor(6*Math.random()),n=new r.default(120*e);n.load().then(function(){return t.monsters.push(n)})}},{key:"draw",value:function(t){this.monsters.forEach(function(e){return e.draw(t)}),this.walls.forEach(function(e){return e.draw(t)}),"LOST"===this.gameState&&t.writeText("You lose!","72px sans-serif","#111111","center",t.width/2,t.height/2)}},{key:"update",value:function(t){var e=this;"LOST"!==this.gameState&&(this.monsters.forEach(function(n){n.update(t),n.yPos>960&&(e.gameState="LOST"),e.walls.forEach(function(t){t.isDestroyed||n.testWallCollision(t)})}),this.walls.forEach(function(e){return e.update(t)}))}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(0);(o=r)&&o.__esModule;var a=null,u=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isMouseDown=!1,this._mouseX=0,this._mouseY=0,e.htmlElement.addEventListener("mousedown",function(){n._isMouseDown=!0}),e.htmlElement.addEventListener("mouseup",function(){n._isMouseDown=!1}),e.htmlElement.addEventListener("mousemove",function(t){n._mouseX=(t.pageX-e.htmlElement.offsetLeft)/e.viewportRatio,n._mouseY=(t.pageY-e.htmlElement.offsetTop)/e.viewportRatio}),a=this}return i(t,[{key:"mouseX",get:function(){return this._mouseX}},{key:"mouseY",get:function(){return this._mouseY}},{key:"isMouseDown",get:function(){return this._isMouseDown}}],[{key:"instance",get:function(){if(null==a)throw new Error("InputHelper is not initialized");return a}}]),t}();e.default=u},function(t,e,n){"use strict";u(n(1));var o=u(n(0)),i=(u(n(4)),u(n(9))),r=u(n(7)),a=u(n(6));function u(t){return t&&t.__esModule?t:{default:t}}var s=new o.default(document.getElementById("main-canvas"));new r.default(s);var l=new a.default,c=[l,new i.default(s,l)];l.spawnMonster();var f=0;function h(){var t=Date.now(),e=(t-f)/1e3;f=t,c.forEach(function(t){t.update(e)}),s.clear(),c.forEach(function(t){t.draw(s)}),requestAnimationFrame(h)}Promise.all(c.map(function(t){return t.load()})).then(function(){f=Date.now(),requestAnimationFrame(h)})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=u(n(1)),r=u(n(2)),a=(u(n(0)),u(n(6)),u(n(7)));function u(t){return t&&t.__esModule?t:{default:t}}n(3);var s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.isPlacingWall=!1,o.wasMouseDown=!1,o.wallToolBounds={x:t.width/2-128-8,y:t.height-120,width:128,height:108},o.wallGrabPos={x:0,y:0},o.grid=n,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),o(e,[{key:"load",value:function(){var t=this;return i.default.loadImage("images/wall.png").then(function(e){t.wallToolImage=e})}},{key:"draw",value:function(t){t.fillRect("#ffffff",0,t.height-130,t.width,130),t.fillRect("#333333",0,t.height-133,t.width,3),t.drawImage(this.wallToolImage,this.wallToolBounds.x,this.wallToolBounds.y,this.wallToolBounds.width,this.wallToolBounds.height),this.isPlacingWall&&t.drawImage(this.wallToolImage,a.default.instance.mouseX-this.wallGrabPos.x,a.default.instance.mouseY-this.wallGrabPos.y,this.wallToolBounds.width,this.wallToolBounds.height,1,1,"hard-light")}},{key:"update",value:function(t){var e;e=this.wallToolBounds,a.default.instance.mouseX>e.x&&a.default.instance.mouseX<e.x+e.width&&a.default.instance.mouseY>e.y&&a.default.instance.mouseY<e.y+e.height&&!this.wasMouseDown&&a.default.instance.isMouseDown&&(this.isPlacingWall=!0,this.wallGrabPos={x:a.default.instance.mouseX-this.wallToolBounds.x,y:a.default.instance.mouseY-this.wallToolBounds.y}),this.isPlacingWall&&this.wasMouseDown&&!a.default.instance.isMouseDown&&(this.grid.addWallPiece(a.default.instance.mouseX,a.default.instance.mouseY),this.isPlacingWall=!1),this.wasMouseDown=a.default.instance.isMouseDown}}]),e}();e.default=s}]);